###############################################################################
########################### Parametros de Projeto #############################
###############################################################################

EXT = cpp
SRCS_EMULADOR = $(patsubst %,%.$(EXT),main vm)
OBJS_EMULADOR = $(patsubst %,build/%.o,$(basename $(SRCS_EMULADOR)))

###############################################################################
########################### Parametros de Ambiente ############################
###############################################################################

CC = gcc
CXX = g++
CCFLAGS = -Wall
CXXFLAGS = -Wall -g
CPPFLAGS = -Iinclude/

###############################################################################
################################ Execut√°veis ##################################
###############################################################################

all: bin/emulador

ifeq ($(EXT), c)
bin/emulador: $(OBJS_EMULADOR)
	@echo "+ Compilando programa \"$@\""
	@$(CC) $(CCFLAGS) $(OBJS_EMULADOR) -o bin/emulador
else
bin/emulador: $(OBJS_EMULADOR)
	@echo "+ Compilando programa \"$@\""
	@$(CXX) $(CXXFLAGS) $(OBJS_EMULADOR) -o bin/emulador
endif

###############################################################################
################################## Objetos ####################################
###############################################################################

ifeq ($(EXT), c)
build/%.o: src/%.c
	@echo "- Compilando objeto \"$@\""
	@$(CC) $(CPPFLAGS) $(CCFLAGS) -c $< -o $@
else
build/%.o: src/%.cpp
	@echo "- Compilando objeto \"$@\""
	@$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $< -o $@
endif

###############################################################################
################################# Auxiliares ##################################
###############################################################################

clean:
	rm -f bin/* $(OBJS_EMULADOR)
